<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="kikita's Blog"><title>在ArcGIS Pro 1.3之外运行arcpy独立脚本 | kikita &amp; Maps</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-74191197-1','auto');ga('send','pageview');</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">在ArcGIS Pro 1.3之外运行arcpy独立脚本</h1><a id="logo" href="/.">kikita &amp; Maps</a><p class="description">For Tech and Fun</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">在ArcGIS Pro 1.3之外运行arcpy独立脚本</h1><div class="post-meta">Aug 31, 2016<span> | </span><span class="category"><a href="/categories/木工开物/">木工开物</a></span></div><div class="post-content"><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>ArcGIS Pro像ArcMap一样，其中也嵌入了Python。 不同在于ArcGIS Pro采用了python较新的版本3.4，ArcMap仍然沿用2.x版本。 ArcGIS Pro 1.3版本开始Python环境有点小变化，为了方便包管理esri开始采用Conda。 并且不像开始 ArcGIS Pro 1.1，1.2 版本，需要单独安装Python for ArcGIS Pro，在1.3版本python包随ArcGIS Pro一同自行安装。</p>
<p>文档的原文摘过来能更好的理解esri采用Conda的意图：</p>
<blockquote>
<p>Python has a rich ecosystem of preexisting packages that can be leveraged within ArcGIS, but managing which packages are installed on a system can be a complex and time-consuming task, especially when working on multiple projects or trying to share code with others.</p>
<p>To leverage this versatility, the Python community has created methods to easily create projects in multiple versions of Python and simplifies the process of installing nearly all publicly available Python packages. Conda is the most popular and widely used Python package manager.</p>
</blockquote>
<p>看到这里，你也也许和我有一样的疑问，<strong>啥是Conda？</strong> 点 <a href="http://pro.arcgis.com/en/pro-app/arcpy/get-started/what-is-conda.htm" target="_blank" rel="noopener"><strong>这里</strong></a> 。这页文档是esri刚更新的内容，需要在英文语言版本文档中才能找到。</p>
<p><br></p>
<h1 id="执行脚本"><a href="#执行脚本" class="headerlink" title="执行脚本"></a>执行脚本</h1><p>这些改变，对于习惯在 ArcGIS Pro 内部的脚本命令行中执行脚本的用户并没有多大影响。 但是如果已经习惯了在ArcGIS Pro 之外独立执行脚本，那如下的改变要注意下了。</p>
<p>ArcGIS Pro 的Python包不再是ArcMap默认安装的位置 <code>C:\Python27</code> ，而是安装在 <code>ArcGIS Pro的安装目录\bin\Python</code> 。</p>
<p>ArcGIS Pro 采用了的Conda环境为 <strong>arcgispro-py3</strong>，有几个方式可以访问这个环境。</p>
<p><br></p>
<h2 id="1-交互式执行python命令"><a href="#1-交互式执行python命令" class="headerlink" title="1. 交互式执行python命令"></a>1. <strong>交互式执行python命令</strong></h2><p>打开ArcGIS Pro安装目录下propy.bat文件，默认位于:<br><code>&quot;C:\Program Files\ArcGIS\Pro\bin\Python\Scripts\propy.bat&quot;</code></p>
<p><img src="http://7xs3vz.com1.z0.glb.clouddn.com/MGKW_ProPythonCommand.png-kikitaMaps" alt=""></p>
<h2 id="2-执行py文件"><a href="#2-执行py文件" class="headerlink" title="2 执行py文件"></a>2 <strong>执行py文件</strong></h2><p>CMD打开命令行窗口，通过propy文件执行脚本，例如默认位置：<br><code>&quot;C:\Program Files\ArcGIS\Pro\bin\Python\Scripts\propy&quot; myscript.py</code><br><img src="http://7xs3vz.com1.z0.glb.clouddn.com/MGKW_ProPythonPY.png-kikitaMaps" alt=""><br>备注：MyScript内容就两行： <code>import arcpy</code>, <code>print(&quot;arcpy imported&quot;)</code></p>
<h2 id="3-批处理py文件"><a href="#3-批处理py文件" class="headerlink" title="3 批处理py文件"></a>3 <strong>批处理py文件</strong></h2><p>通过 call 函数来调用 propy </p>
<p><code>@echo Run my Python script
call &quot;%PROGRAMFILES%\ArcGIS\Pro\bin\Python\Scripts\propy&quot; myscript.py
@echo Finished</code></p>
<p>例子：<br><img src="http://7xs3vz.com1.z0.glb.clouddn.com/MGKW_ProPythonBat.png-kikitaMaps" alt=""><br>备注： 三个脚本分别打印 AAA, BBB, CCC。</p>
<p><br></p>
<p><br></p>
<h1 id="使用Python-IDE"><a href="#使用Python-IDE" class="headerlink" title="使用Python IDE"></a>使用Python IDE</h1><p>有一个好用IDE是件美好的事情，大家应该都有各自的真爱，我就不做任何推荐啦。 在Pro之外独立执行脚本导入arcpy站点包的时候，只要注意将Python解释器的路径指向正确即可。</p>
<p>如果你的机器上既安装了ArcGIS Desktop，又安装了ArcGIS Server或者ArcGIS Desktop的后台64位补丁包，并且又安装了ArcGIS Pro， 那么可能在机器上有多个Python环境。</p>
<p>我自己在用 Pycharm ，在需要导入 ArcGIS Pro 的python站点包时，注意指向： <code>&quot;C:\Program Files\ArcGIS\Pro\bin\Python\envs\arcgispro-py3\python.exe&quot;</code></p>
<p><img src="http://7xs3vz.com1.z0.glb.clouddn.com/MGKW_ProPythonPycharm.png-kikitaMaps" alt=""></p>
<p><br></p>
<p>注意，在python IDE 中<strong>不要</strong>将解释器指向这个 python.exe , <code>[&quot;C:\Program Files\ArcGIS\Pro\bin\Python\python.exe&quot;]</code></p>
<p>否则你在导入 arcpy 模块时会遇到找不到模块的错误： <strong>ImportError: No module named ‘arcpy’</strong></p>
<p><br></p>
<p>最后推荐 <a href="https://geonet.esri.com/docs/DOC-8359" target="_blank" rel="noopener">一篇esri的Blog</a>，也详细的阐述的这件事。</p>
</div><iframe src="/donate/?AliPayQR=/img/AliPayQR.png&amp;WeChatQR=/img/WeChatQR.png&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="http://www.kikitamap.com/2016/08/31/ArcGISProPython/" data-id="cjjgw9l2200e2n8os4njzr92o" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJElEQVR42u3aMZbDIAwFwNz/0tl2i13yP3IKm6HyS4zNNDKSeL3i8f41fv+yvvO/e9bPXM8aDQwMjNsy3suxvid5cvKE9r1/vB0DA+MARrKI9eImQTN514c1Y2BgYJTXe9tKDAwMjKsY67l5OP5vLgYGBsYkiU2C6SStzVNfDAyM0xhXJZnfuP5KfwMDA+NWjHc52m3cXoisV4WBgfFoRh7g2iMU+aZwL+BiYGCcw1gH0yRNzZPPvYZlFKwxMDAOYLTT9jaReaugLcNhYGCcwNgLjm3ca1sORekNAwPjGEbSVsz/nRy2GB2zwMDAeCgjT2g3A2L5rvqABQYGxgGMSdGtbXAmQbltMGBgYJzDSAB58M1bC3lYj8ptGBgYD2W8BiNPNduUdf3k+rQIBgbGbRltKa3NHPcaCZt3YmBgPJTRbvWKYv3X0uB6a4iBgXFzxrUls3zDN/o+YGBgYGylrMms+VHXIonFwMB4NKM9bJova0KNjr1iYGAcwJgsKy+95Vu9fBYGBsY5jEkDYHJQI9+SFuU2DAyMAxg5JpmbL2s0CwMD46GMdzna1mN+5KJtP2xmwBgYGDdkTIr77dawDazJdQ3DwMC4LePalsA8cOdHOjAwME5j5IFvVBQbBOIPJTwMDAyMOKS2R8qSjWDUSMDAwMAIktV2yzhJay/7bmBgYNyKkSSxVxX690Lzh7YEBgbGoxl56nhV0ruHSX7BwMB4HOMHlD50cuPmapYAAAAASUVORK5CYII=">Share</a><div class="tags"><a href="/tags/Python/">Python</a><a href="/tags/ArcGIS-Pro/">ArcGIS Pro</a></div><div class="post-nav"><a class="pre" href="/2016/09/02/TripToHngKong/">Trip To HngKong</a><a class="next" href="/2016/06/30/QueryLayerResult/">Make Query Layer在Model Builder中的使用</a></div><div id="lv-container" data-id="city" data-uid="MTAyMC8zMjMyOC84ODg5"><script>(function(d, s) {
   var j, e = d.getElementsByTagName(s)[0];
   if (typeof LivereTower === 'function') { return; }
   j = d.createElement(s);
   j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
   j.async = true;
   e.parentNode.insertBefore(j, e);
})(document, 'script');
</script></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/木工开物/">木工开物</a><span class="category-list-count">160</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/相机里/">相机里</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/碎碎念/">碎碎念</a><span class="category-list-count">7</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Spatial-Analyst/" style="font-size: 15px;">Spatial Analyst</a> <a href="/tags/Geoprocessing/" style="font-size: 15px;">Geoprocessing</a> <a href="/tags/Spatial-Statistics/" style="font-size: 15px;">Spatial Statistics</a> <a href="/tags/Mapping/" style="font-size: 15px;">Mapping</a> <a href="/tags/CAD/" style="font-size: 15px;">CAD</a> <a href="/tags/Geodata/" style="font-size: 15px;">Geodata</a> <a href="/tags/Coordinate-System/" style="font-size: 15px;">Coordinate System</a> <a href="/tags/Performance/" style="font-size: 15px;">Performance</a> <a href="/tags/ArcPad/" style="font-size: 15px;">ArcPad</a> <a href="/tags/Raster/" style="font-size: 15px;">Raster</a> <a href="/tags/Deployment/" style="font-size: 15px;">Deployment</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/3D/" style="font-size: 15px;">3D</a> <a href="/tags/CityEngine/" style="font-size: 15px;">CityEngine</a> <a href="/tags/License/" style="font-size: 15px;">License</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/ArcGIS-Enterprise/" style="font-size: 15px;">ArcGIS Enterprise</a> <a href="/tags/ArcGIS-Pro/" style="font-size: 15px;">ArcGIS Pro</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a> <a href="/tags/Map-Story/" style="font-size: 15px;">Map Story</a> <a href="/tags/CGA/" style="font-size: 15px;">CGA</a> <a href="/tags/Visual-Studio/" style="font-size: 15px;">Visual Studio</a> <a href="/tags/Certification/" style="font-size: 15px;">Certification</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/07/11/CEFreeTrial/">如何获取30天试用版 Esri CityEngine ？</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/10/pythonInCE/">在 CityEngine 中使用 Python</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/04/Parthenon/">Parthenon Temple</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/30/textureinCE2/">CityEngine中纹理贴图之道(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/22/textureinCE/">CityEngine中纹理贴图之道(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/21/importingmodels/">导入3D模型至CityEngine</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/18/ScentofaWoman/">《Scent of a Woman》</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/15/osm2ce/">OSM在ArcGIS产品线中的使用小结</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/13/CEMaplayer/">CityEngine中的Terrain Map Layer</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/09/ProNamedUserforPortalUse/">如何部署通过Portal管理的ArcGIS Pro Named User许可？</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://zhihu.esrichina.com.cn/" title="ArcGIS知乎" target="_blank">ArcGIS知乎</a><ul></ul><a href="http://blog.newnaw.com/" title="菩提老王的葡萄架子" target="_blank">菩提老王的葡萄架子</a><ul></ul><a href="http://oopsliu.com/" title="OopsLiu" target="_blank">OopsLiu</a><ul></ul><a href="https://makeling.github.io/" title="UBUNTU SPACE" target="_blank">UBUNTU SPACE</a><ul></ul><a href="http://blog.csdn.net/kikitamoon" title="慕名ArcGIS_CSDN" target="_blank">慕名ArcGIS_CSDN</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">kikita &amp; Maps.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>